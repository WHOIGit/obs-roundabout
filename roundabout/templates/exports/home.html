<!--
# Copyright (C) 2019-2020 Woods Hole Oceanographic Institution
#
# This file is part of the Roundabout Database project ("RDB" or
# "ooicgsn-roundabout").
#
# ooicgsn-roundabout is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 2 of the License, or
# (at your option) any later version.
#
# ooicgsn-roundabout is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with ooicgsn-roundabout in the COPYING.md file at the project root.
# If not, see <http://www.gnu.org/licenses/>.
-->

{% extends "base.html" %}
{% load static i18n %}
{% load mptt_tags %}
{% load crispy_forms_tags %}
{% block title %}Exports{% endblock %}

{% block content %}
<div class="container">

  <h2>Bulk Exports</h2>
  <p>Use this interface to bulk download certain DB content</p>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:vessels' %}">Export Vessels</a></p></div>
    <div class="col-9"><p>Downloads a shiplist.csv file</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:cruises' %}">Export Cruises</a></p></div>
    <div class="col-9"><p>Downloads a CruiseInformation.csv file</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:deployments' %}">Export Deployments</a></p></div>
    <div class="col-9"><p>Downloads a zip of deployment csv files</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:calibrations' %}">Export Calibrations</a></p></div>
    <div class="col-9"><p>Downloads a zip of calibration csv files</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:configconsts' %}">Export Configurations & Constants</a></p></div>
    <div class="col-9"><p>Downloads a zip of configuration event csv files (incl. constants)</p></div>
  </div>

  {% if rdb_site_url == "https://obs-rdb.whoi.edu" %}
  <br><br><a type=button class="btn btn-primary" href="{% url 'exports:obs_allbuilds' %}">Export Builds [OBS]</a>
{% else %}
  <br><br><a type=button class="btn btn-primary" href="{% url 'exports:CI' %}">Export All [CI]</a>
{% endif %}

  <hr>

  <h2>Bulk Exports: CI spec</h2>
  <p>Exports for CI require specific schema and requirements so as to match the OOI CI Asset Management GitHub CSVs.</p>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:CI' %}">Export All <span class="text-monospace">[CI]</span></a></p></div>
    <div class="col-9"><p>Exports all the below assets to a single zip file named Asset-Management.zip</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:vessels' %}?ci">Export Vessels <span class="text-monospace">[CI]</span></a></p></div>
    <div class="col-9"><p>Vessels Export is congruous with its respective export function above, with the exception of an ommitted "Notes" column.</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:cruises' %}?ci">Export Cruises <span class="text-monospace">[CI]</span></a></p></div>
    <div class="col-9"><p>Cruises Export is congruous with its respective export function above, with the exception of ommitted "Friendly Name" and "Destination" columns.</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:deployments' %}">Export Deployments</a></p></div>
    <div class="col-9"><p>Deployment Exports is congruous its respective export function above.</p></div>
  </div>

  <div class="row">
    <div class="col-3"><p><a type=button class="btn btn-primary" href="{% url 'exports:calibrations_with_configs' %}">Export Calibrations with Configurations and Constants</a></p></div>
    <div class="col-9"><p>This export function is highly specialized. The CalibrationEvents_withConfigs.zip will contain zero or more CI CCC csv files, and a CalibrationsWithConfigs_EXPORTLOG.txt logfile.</p>
      <p>CCC events that pass <span class="font-italic">all</span> the following Requirements must feature:</p>
      <ul>
        <li>CCCs must be reviewed/approved by at least two Users</li>
        <li>CCCs defined for a Part must be found for the associated Inventory item</li>
        <li>Inventory must have an associated Assembly part and not be in the Trash location</li>
        <li>Calibration events must be dated before their associated configuration events</li>
        <li>"Export with Calibrations" flag must be checked for Configurations and Constants for the Part</li>
      </ul>
      <p>In addition to CCC files, a CalibrationsWithConfigs_EXPORTLOG.txt log file describing the process of vetting CCC files for download is included. If you are not seeing a CCC file you were expectiong, check the CalibrationsWithConfigs_EXPORTLOG.txt for your expected file; it may well tell you why it did not export.</p>
      <p>CalibrationsWithConfigs_EXPORTLOG.txt is not part of the OOI Asset Management GitHub CSV schema and so, before comparison, it will have to be removed so as not to create an error.</p>
    </div>
  </div>

</div>

</div>
{% endblock %}
